{% extends "base.html" %}
{% block title %}AI Insights{% endblock %}
{% block content %}
<h1 class="page-title">AI & Machine Learning Insights</h1>

<div class="content-area">
    <!-- ML System Status -->
    <div class="info-card {% if ml_available and ml_enabled %}success{% else %}warning{% endif %}">
        <div class="info-header">
            <i class="fas fa-robot"></i>
            <h3>Machine Learning Status</h3>
        </div>
        <div class="info-body">
            {% if ml_available %}
                <div class="status-item">
                    <i class="fas fa-check-circle" style="color: #4CAF50;"></i>
                    <span>scikit-learn library is <strong>INSTALLED</strong></span>
                </div>
                {% if ml_enabled %}
                    <div class="status-item" style="margin-top: 10px;">
                        <i class="fas fa-check-circle" style="color: #4CAF50;"></i>
                        <span>ML features are <strong>ENABLED</strong></span>
                    </div>
                {% else %}
                    <div class="status-item" style="margin-top: 10px;">
                        <i class="fas fa-exclamation-circle" style="color: #ff9800;"></i>
                        <span>ML features are <strong>DISABLED</strong> in config</span>
                    </div>
                {% endif %}
            {% else %}
                <div class="status-item">
                    <i class="fas fa-times-circle" style="color: #f44336;"></i>
                    <span>scikit-learn library is <strong>NOT INSTALLED</strong></span>
                </div>
                <div style="background: rgba(33, 150, 243, 0.1); border-left: 4px solid #2196F3; padding: 15px; margin-top: 15px; border-radius: 4px;">
                    <strong>Action Required:</strong> Install scikit-learn to enable ML features:<br>
                    <code style="background: #333; color: #4CAF50; padding: 4px 8px; border-radius: 4px; display: inline-block; margin-top: 8px;">pip install scikit-learn</code>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- ML Models Status -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
        <div class="model-card">
            <div style="text-align: center; color: #4CAF50; font-size: 3em; margin-bottom: 15px;">
                <i class="fas fa-chart-line"></i>
            </div>
            <h3 style="text-align: center; color: #e0e0e0; margin-bottom: 10px;">Anomaly Detection</h3>
            <div style="text-align: center; padding: 8px; border-radius: 6px; margin-bottom: 15px; {% if anomaly_model_loaded %}background: rgba(76, 175, 80, 0.2); color: #4CAF50;{% else %}background: rgba(255, 152, 0, 0.2); color: #ff9800;{% endif %}">
                {% if anomaly_model_loaded %}
                    <i class="fas fa-check-circle"></i> Model Active
                {% else %}
                    <i class="fas fa-times-circle"></i> Not Loaded
                {% endif %}
            </div>
            <p style="text-align: center; color: #bbb; line-height: 1.6;">
                Monitors sensor data for unusual patterns and potential equipment failures using Isolation Forest algorithm.
            </p>
        </div>
        
        <div class="model-card">
            <div style="text-align: center; color: #4CAF50; font-size: 3em; margin-bottom: 15px;">
                <i class="fas fa-cog"></i>
            </div>
            <h3 style="text-align: center; color: #e0e0e0; margin-bottom: 10px;">Actuation Model</h3>
            <div style="text-align: center; padding: 8px; border-radius: 6px; margin-bottom: 15px; {% if actuation_model_loaded %}background: rgba(76, 175, 80, 0.2); color: #4CAF50;{% else %}background: rgba(255, 152, 0, 0.2); color: #ff9800;{% endif %}">
                {% if actuation_model_loaded %}
                    <i class="fas fa-check-circle"></i> Model Active
                {% else %}
                    <i class="fas fa-times-circle"></i> Not Loaded
                {% endif %}
            </div>
            <p style="text-align: center; color: #bbb; line-height: 1.6;">
                Predicts optimal actuator control decisions based on environmental conditions using Decision Tree.
            </p>
        </div>
    </div>

    <!-- Features Info -->
    <div class="info-card info">
        <div class="info-header">
            <i class="fas fa-lightbulb"></i>
            <h3>AI Features</h3>
        </div>
        <div class="info-body">
            <ul class="info-list">
                <li><strong>Real-time Anomaly Detection:</strong> Continuously monitors sensor readings to detect unusual patterns</li>
                <li><strong>Predictive Maintenance:</strong> Identifies potential equipment issues before they become critical</li>
                <li><strong>Smart Automation:</strong> AI-driven actuator control for optimal growing conditions</li>
                <li><strong>Learning from Data:</strong> Models improve over time as they observe more growing cycles</li>
            </ul>
        </div>
    </div>

    <!-- Configuration Info -->
    <div class="info-card info">
        <div class="info-header">
            <i class="fas fa-cog"></i>
            <h3>Configuration</h3>
        </div>
        <div class="info-body">
            <p class="info-text">
                ML features can be enabled/disabled in <code style="background: #333; color: #4CAF50; padding: 2px 6px; border-radius: 4px;">config/config.yaml</code>:
            </p>
            <pre style="background: #333; padding: 15px; border-radius: 6px; color: #e0e0e0; overflow-x: auto; margin: 15px 0;">system:
  ml_enabled: true  # Set to false to disable ML features</pre>
            <p class="info-text">
                Models are automatically trained and updated based on historical sensor data.
            </p>
        </div>
    </div>
</div>

<style>
.model-card {
    background-color: #2c2c2c;
    border-radius: 8px;
    padding: 25px;
    border: 1px solid #444;
}
.status-item {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #e0e0e0;
}
</style>
{% endblock %}
